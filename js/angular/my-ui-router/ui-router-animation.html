<!DOCTYPE html>
<html ng-app="myapp">

<head>
    <title>AngularJS: UI-Router Quick Start</title>
    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.1/css/bootstrap.css" rel="stylesheet">
    <link href="http://daneden.github.io/animate.css/animate.min.css" rel="stylesheet">
    <style>
        .well[ui-view] {
            height: 65px;
        }

        .ui-view-container {
            position: relative;
        }

        [ui-view].ng-enter, [ui-view].ng-leave {
            position: absolute;
            left: 0;
            right: 0;
        }

        [ui-view].ng-enter {
            -webkit-animation: slideInRight 0.5s;
            animation: slideInRight 0.5s;
        }

        [ui-view].ng-enter-active {

        }

        [ui-view].ng-leave {
            -webkit-animation: slideOutLeft 0.5s;
            animation: slideOutLeft 0.5s;
        }

        [ui-view].ng-leave-active {

        }

        [ui-view].ng-enter.back {
            -webkit-animation: slideInLeft 0.5s;
            animation: slideInLeft 0.5s;
        }

        [ui-view].ng-leave.back {
            -webkit-animation: slideOutRight 0.5s;
            animation: slideOutRight 0.5s;
        }
    </style>
</head>

<body class="container">

<p><i>Best viewed in pop-out mode to see location changes. Click blue button on the right.</i></p>

<div class="navbar">
    <div class="navbar-inner">
        <a class="brand" href="#">Quick Start</a>
        <ul class="nav">
            <li><a href="#/foo">foo</a></li>
            <li><a href="#/bar">bar</a></li>
        </ul>
    </div>
</div>

<div class="row">
    <div class="span12 ui-view-container">
        <div class="well" ui-view></div>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.15/angular.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.15/angular-animate.js"></script>
<script src="https://cdn.bootcss.com/angular-ui-router/0.2.18/angular-ui-router.js"></script>

<!-- App Script -->
<script>
    var myapp = angular.module('myapp', ["ui.router", "ngAnimate"]);

    myapp.config(['$urlMatcherFactoryProvider', function ($urlMatcherFactoryProvider) {
        $urlMatcherFactoryProvider.strictMode(false);
    }]);

    myapp.config(['$urlRouterProvider', function ($urlRouterProvider) {
        $urlRouterProvider.otherwise("/foo");
    }]);

    //http://stackoverflow.com/questions/16094940/what-is-the-lifecycle-of-an-angularjs-controller
    myapp.config(function ($stateProvider) {

        $stateProvider
                .state("foo", {
                    url: "/foo?back",
                    template: '<h1>foo</h1>' +
                    '<ul>' +
                    '  <li><a ng-click="forward()">forward</a></li>' +
                    '</ul>',

                    controller: function ($scope, $element, $state, $stateParams) {
                        console.log("----------foo.$stateParams ", $stateParams);
                        if ($stateParams.back) {
                            $element.addClass("back")
                        } else {
                            $element.removeClass("back")
                        }
                        $scope.$on('$viewContentAnimationEnded', function () {
                            $element.removeClass("back");
                        });

                        $scope.forward = function () {
                            $state.go("bar")
                        };
                    }
                })
                .state("bar", {
                    url: "/bar?back",
                    template: '<h1>bar</h1>' +
                    '<ul>' +
                    '  <li><a ng-click="forward()"> forward</a></li>' +
                    '  <li><a ng-click="back()"> back</a></li>' +
                    '</ul>',
                    controller: function ($scope, $element, $state, $stateParams) {
                        if ($stateParams.back) {
                            $element.addClass("back")
                        } else {
                            $element.removeClass("back")
                        }
                        $scope.$on('$viewContentAnimationEnded', function () {
                            $element.removeClass("back");
                        });

                        $scope.forward = function () {
                            $state.go("baz")
                        };
                        $scope.back = function () {
                            $element.addClass("back");
                            $state.go("foo", {back: true});
                        };

                    }
                })
                .state("baz", {
                    url: "/baz",
                    template: '<h1>baz</h1>' +
                    '<ul>' +
                    '  <li><a ng-click="back()"> back</a></li>' +
                    '</ul>',
                    controller: function ($scope, $element, $state, $stateParams) {
                        if ($stateParams.back) {
                            $element.addClass("back")
                        } else {
                            $element.removeClass("back")
                        }
                        $scope.$on('$viewContentAnimationEnded', function () {
                            $element.removeClass("back");
                        });

                        $scope.back = function () {
                            $element.addClass("back")
                            $state.go('bar', {back: true})
                        };
                    }
                });

    });

    myapp.run(['$rootScope', '$stateParams', function ($rootScope, $stateParams) {
        $rootScope.$on('$stateChangeSuccess', function (event, toState, toParams, fromState, fromParams) {
            console.debug("$stateChangeSuccess : " +
                    "fromState = " + JSON.stringify(fromState.name) +
                    ", toState = " + JSON.stringify(toState.name) +
                    ", fromParams = " + JSON.stringify(fromParams) +
                    ", toParams = " + JSON.stringify(toParams)
            );
            $rootScope.$stateParams = $stateParams;
        });
    }]);
</script>

</body>

</html>