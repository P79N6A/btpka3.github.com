<!DOCTYPE html>
<html lang="en" ng-app="MyApp" ng-controller="DemoCtrl as ctrl" layout="column" ng-cloak="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, flexinitial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <title>study md-icon</title>
    <link rel="stylesheet" href="https://unpkg.com/material-design-icons-font@2.2.3/iconfont/material-icons.css">
    <link rel="stylesheet" href="https://unpkg.com/angular-material@1.1.1/angular-material.css"/>
    <link rel="stylesheet" href="https://unpkg.com/angular-material-icons@0.7.1/angular-material-icons.css"/>

    <style>

    </style>
</head>
<body layout="">

<div flex="" layout="column">
    <div layout="row">
        <div flex="" layout="column">
            <md-button class="md-primary md-raised" ng-click="vs.tab='a'">tab 1</md-button>
            <md-checkbox ng-repeat="i in data.a " ng-model="vs.a[i.v]">{{i.v}}</md-checkbox>
        </div>
        <div flex="" layout="column">
            <md-button class="md-primary md-raised" ng-click="vs.tab='b'">tab 2</md-button>
            <md-checkbox ng-repeat="i in data.b " ng-model="vs.b[i.v]">{{i.v}}</md-checkbox>
        </div>
    </div>
    <div>
        <md-checkbox ng-checked="isSelectAll()" ng-click="toggleAll()">全选</md-checkbox>
        <div> $scope.data =
            <pre>{{data|json}}</pre>
        </div>
        <div> $scope.vs =
            <pre>{{vs|json}}</pre>
        </div>
        <div>isSelectAll = {{isSelectAll()}}</div>
    </div>

</div>


</body>
<script src="https://unpkg.com/jquery@3.1.1/dist/jquery.js"></script>
<script src="https://unpkg.com/angular@1.6.1/angular.js"></script>
<script src="https://unpkg.com/angular-animate@1.6.1/angular-animate.js"></script>
<script src="https://unpkg.com/angular-aria@1.6.1/angular-aria.js"></script>
<script src="https://unpkg.com/angular-messages@1.6.1/angular-messages.js"></script>
<script src="https://unpkg.com/angular-material@1.1.1/angular-material.js"></script>
<script src="https://unpkg.com/angular-material-icons@0.7.1/angular-material-icons.js"></script>
<script src="https://unpkg.com/svg-morpheus@0.3.0/compile/minified/svg-morpheus.js"></script>
<script>
    (function () {
        angular
                .module('MyApp', ['ngMaterial', 'ngMessages', 'ngMdIcons'])
                .controller('DemoCtrl', ['$scope', function ($scope) {

                    // 模拟从后台返回的数据
                    $scope.data = {
                        a: [
                            {
                                v: "a01"
                            },
                            {
                                v: "a02"
                            },
                            {
                                v: "a03"
                            }
                        ],
                        b: [
                            {
                                v: "b01"
                            },
                            {
                                v: "b02"
                            },
                            {
                                v: "b03"
                            }
                        ]
                    };

                    // 页面显示用的状态控制
                    $scope.vs = {
                        tab: "a",
                        a: {
                            a01: true,
                            a02: true,
                            a03: false
                        },
                        b: {
                            b01: true,
                            b02: false,
                            b03: false
                        }
                    };

                    $scope.isSelectAll = function () {
                        var arr = $scope.data[$scope.vs.tab];
                        for (var i = 0; i < arr.length; i++) {
                            if (!$scope.vs[$scope.vs.tab][arr[i].v]) {
                                return false;
                            }
                        }
                        return true;
                    };

                    $scope.toggleAll = function () {

                        var newValue = !$scope.isSelectAll();
                        var arr = $scope.data[$scope.vs.tab];

                        for (var i = 0; i < arr.length; i++) {
                            $scope.vs[$scope.vs.tab][arr[i].v] = newValue;
                        }
                    };
                }]);
    })();

</script>
</html>